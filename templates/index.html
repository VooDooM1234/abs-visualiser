<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Plotly JS (global) -->
    <script src="https://cdn.plot.ly/plotly-3.1.0.min.js" charset="utf-8"></script>

    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@2.0.6/dist/htmx.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/dashboard.css" />

    <title>Home Page</title>
  </head>
  <body class="container my-4">
    <h1 class="text-center mb-4">HELLO WORLD</h1>

    <!-- HTMX will swap in the plot container here -->
    <div
      id="plot-test"
      hx-get="/plot/test/"
      hx-trigger="load"
      hx-swap="outerHTML"
    ></div>

    <script>
  document.body.addEventListener('htmx:afterSwap', function(evt) {
    if (evt.detail.target.id === "plot-test") {
      fetch("/plot/test/json/")
        .then(r => r.json())
        .then(fig => {
          // Wait for the DOM to update
          setTimeout(function() {
            const plotDiv = document.getElementById("plot-test");
            if (plotDiv) {
              Plotly.newPlot("plot-test", fig.data, fig.layout);
            }
          }, 0);
        });
    }
  });
</script>
  </body>
</html>